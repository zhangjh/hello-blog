<!doctype html><html class="theme-next use-motion"><head><meta name=generator content="Hexo 3.8.0"><meta charset=UTF-8><meta http-equiv=Content-Language content=zh-CN><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1"><meta http-equiv=Cache-Control content=no-transform><meta http-equiv=Cache-Control content=no-siteapp><meta http-equiv=Cache-Control content="max-age=864000"><meta name=google-site-verification content=4uI2zlyLHcOQWwwZFmW5SB6dj9mlInB8lIUfeM_L8d8><meta name=baidu_union_verify content=9f6bc0068b476b9afebdb405dbd92112><link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel=stylesheet type=text/css><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel=stylesheet type=text/css><link href="/css/main.css?v=1.0.0.0" rel=stylesheet type=text/css><link rel=canonical href=https://zhangjh.me><meta name=keywords content="Hexo,dante notes,但丁笔记,git,javascript,技术人生"><link rel=alternate href=/rss2.xml title=但丁笔记 type=application/atom+xml><link rel="shortcut icon" type=image/x-icon href="/favicon.ico?v=1.0.0.0"><meta name=description content="一个伪文青，一个low geek 孤单的坚持码字"><meta property=og:type content=website><meta property=og:title content=但丁笔记><meta property=og:url content=http://zhangjh.me/page/4/index.html><meta property=og:site_name content=但丁笔记><meta property=og:description content="一个伪文青，一个low geek 孤单的坚持码字"><meta property=og:locale content=zh-Hans><meta name=twitter:card content=summary><meta name=twitter:title content=但丁笔记><meta name=twitter:description content="一个伪文青，一个low geek 孤单的坚持码字"><script type=text/javascript id=hexo.configuration>
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'hide',
    motion: true
  };
</script><script type=text/javascript src="/vendors/jquery/index.js?v=2.1.3"></script><title>但丁笔记 --一个理想主义文青的IT自留地</title><style>
    #msg-tip {
      background-color: orangered;
      color: white;
      position: fixed;
      top: 50px;
      right: 10px;
      z-index: 2;
      display: none;
      cursor: pointer;
    }
    #msg-modal {
      position: fixed;
      top: 20%;
      left: 50%;
      width: 400px;
      margin-left: -200px;
      z-index: 2;
      -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, .5);
      -moz-box-shadow: 0 5px 15px rgba(0, 0, 0, .5);
      box-shadow: 0 5px 15px rgba(0, 0, 0, .5);
      padding: 5px 20px;
      background: white;
      display: none;
    }
    #msg-modal h5 {
      float: left;
    }
    #msg-modal .close {
      float: right;
    }
    #modal-body {
      clear: both;
    }
    #modal-body .item a {
      color: #219bde;
    }
  </style></head><body><div id=msg-tip>❗️你有<span>0</span>条未读消息</div><div id=msg-modal><div id=modal-header><h5>消息列表</h5><span class=close>X</span></div><div id=modal-body></div></div><div class="container one-column page-home"><div class=headband></div><header id=header class=header><div class=header-inner><div class=site-meta><div class=custom-logo-site-title><a href="/" class=brand rel=start><span class=logo-line-before><i></i></span> <span class=site-title>但丁笔记</span> <span class=logo-line-after><i></i></span></a></div><p class=site-subtitle></p></div><div class=site-nav-toggle><button><span class=btn-bar></span> <span class=btn-bar></span> <span class=btn-bar></span></button></div><nav class=site-nav><ul id=menu class="menu menu-left"><li class="menu-item menu-item-home"><a href="/" rel=section><i class="menu-item-icon fa fa-home fa-fw"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href=/categories rel=section><i class="menu-item-icon fa fa-th fa-fw"></i><br>分类</a></li><li class="menu-item menu-item-about"><a href=/about rel=section><i class="menu-item-icon fa fa-user fa-fw"></i><br>关于</a></li><li class="menu-item menu-item-archives"><a href=/archives rel=section><i class="menu-item-icon fa fa-archive fa-fw"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href=/tags rel=section><i class="menu-item-icon fa fa-tags fa-fw"></i><br>标签</a></li><li class="menu-item menu-item-search"><a href=/search rel=section><i class="menu-item-icon fa fa-question-circle fa-fw"></i><br>搜索</a></li><li class="menu-item menu-item-commonweal"><a href=/404 rel=section style="font-weight: bold"><i class="menu-item-icon fa fa-heartbeat fa-fw"></i><br>公益404</a></li></ul><div class=site-search><form class=site-search-form target=_blank action=http://zhannei.baidu.com/cse/site><input type=text name=q size=30 placeholder=站内搜索> <input type=hidden name=cc value=zhangjh.me></form></div></nav></div></header><main id=main class=main><div class=main-inner><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2017/01/01/ant-design的select组件onSelect事件简析/" itemprop=url>ant-design的select组件onSelect事件简析</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2017-01-01T17:53:45+08:00 content=2017-01-01>2017-01-01</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><span itemprop=articleBody><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><p>最近刚入react的坑，前端的布局和控件设计用的是阿里的开源框架：<a href=http://ant.design target=_blank rel=noopener>ant-design</a>。ant-design不失为一款好用的设计框架，与bootstrap类似，比bootstrap好看，只是必须结合react使用。跟阿里其他的开源工具类似地，存在一个共同的通病，亦或者可以说是所有国有开源软件的通病：文档写的不够细致。<br>ant-design也是这样，在官方文档中经常有一些说的不够的地方，让使用者看的莫名所以。最典型的要数针对控件的API的事件参数的说明了，在这上面已经踩了很多的坑。有的是不知道参数传入的意义，有的是参数传递的使用方法说的不够具体等。本篇就一个具体的问题：Select选择器的onSelect事件记录一下踩坑的经历。</p><h2 id=问题><a href=#问题 class=headerlink title=问题></a>问题</h2><p>我在开发中用到了如下代码片段：<br><figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>const</span> options = options.map(<span class=function><span class=params>d</span> =&gt;</span> &#123;</span><br><span class=line>	<span class=keyword>return</span> <span class=xml><span class=tag>&lt;<span class=name>Option</span> <span class=attr>key</span>=<span class=string>&#123;d.id&#125;</span>&gt;</span>&#123;d.value&#125;<span class=tag>&lt;/<span class=name>Option</span>&gt;</span></span>;</span><br><span class=line>&#125;);</span><br><span class=line>&lt;Select onSelect=&#123;<span class=keyword>this</span>.props.onSelect&#125;&gt;</span><br><span class=line>	&#123;options&#125;</span><br><span class=line>&lt;<span class=regexp>/Select&gt;</span></span><br></pre></td></tr></table></figure></p><p>其中key属性是按照react的官方要求，遍历数组元素生成控件时要添加一个唯一的key属性供react的diff算法渲染。<br>渲染没有问题，在下拉选择的时候onSelect获取的参数值总是跟预期的不一致，在上例中，onSelect接收的总是key的值，然而官方文档里说：被选中时调用，参数为选中项的value值。</p><h2 id=探索><a href=#探索 class=headerlink title=探索></a>探索</h2><p>文档除了那一句话外就没多说了，既然文档写的语焉不详，那么只好写测试自己琢磨了。</p><ol><li><p>测试代码1</p><figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>import</span> &#123; Select &#125; <span class=keyword>from</span> <span class=string>'antd'</span>;</span><br><span class=line><span class=keyword>const</span> Option = Select.Option;</span><br><span class=line></span><br><span class=line></span><br><span class=line>ReactDOM.render(</span><br><span class=line>  &lt;Select value=<span class=string>"test"</span></span><br><span class=line>	onSelect=&#123;<span class=function><span class=keyword>function</span>(<span class=params>value</span>)</span>&#123;alert(value);&#125;&#125;</span><br><span class=line>  &gt;</span><br><span class=line>	&lt;Option key=&#123;<span class=number>1</span>&#125;&gt;</span><br><span class=line>	  <span class=number>111</span></span><br><span class=line>	&lt;<span class=regexp>/Option&gt;</span></span><br><span class=line><span class=regexp>	&lt;Option key=&#123;2&#125;&gt;</span></span><br><span class=line><span class=regexp>	222</span></span><br><span class=line><span class=regexp>	&lt;/</span>Option&gt;</span><br><span class=line>  &lt;<span class=regexp>/Select&gt;</span></span><br><span class=line><span class=regexp>  , mountNode);</span></span><br></pre></td></tr></table></figure><p>运行后发现确实是选择111时弹出1，选择222时弹出2，获取的是key。。。</p></li><li><p>测试代码2</p><figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>import</span> &#123; Select &#125; <span class=keyword>from</span> <span class=string>'antd'</span>;</span><br><span class=line><span class=keyword>const</span> Option = Select.Option;</span><br><span class=line></span><br><span class=line></span><br><span class=line>ReactDOM.render(</span><br><span class=line>  &lt;Select value=<span class=string>"test"</span></span><br><span class=line>	onSelect=&#123;<span class=function><span class=keyword>function</span>(<span class=params>value</span>)</span>&#123;alert(value);&#125;&#125;</span><br><span class=line>  &gt;</span><br><span class=line>	&lt;Option value=&#123;<span class=number>1</span>&#125;&gt;</span><br><span class=line>	  <span class=number>111</span></span><br><span class=line>	&lt;<span class=regexp>/Option&gt;</span></span><br><span class=line><span class=regexp>	&lt;Option value=&#123;2&#125;&gt;</span></span><br><span class=line><span class=regexp>	222</span></span><br><span class=line><span class=regexp>	&lt;/</span>Option&gt;</span><br><span class=line>  &lt;<span class=regexp>/Select&gt;</span></span><br><span class=line><span class=regexp>  , mountNode);</span></span><br></pre></td></tr></table></figure><p>怀疑官网说的value不是option的value值而是value属性，于是将key属性换成value。结果果然是选择111时弹出1，选择222的时候弹出2了。</p></li></ol><p>验证了猜想，文档里说的onSelect的参数是被选中项的value属性而不是值，并且可恶的地方在于，没有设置value属性的时候竟然会返回key属性。。。要么说明下，要么按照文档的如实返回，返回key属性这不是挖坑了吗！</p></span></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/12/22/error-commit/" itemprop=url>解决git报错:".git/hooks/pre-commit No such file or directory"</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-12-22T16:22:00+08:00 content=2016-12-22>2016-12-22</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><span itemprop=articleBody><p>第二次遇到这个问题了，第一次删除了.git目录重新下载了项目，结果commit记录什么的都不对了，损失惨重，这次又遇到这个问题没敢轻举妄动了，折腾了很久，终于找到了问题的根源，这里记录一下以备忘，顺便给遇到同样问题的朋友们一点启发。</p><p>这个问题的根源在于跨平台造成的换行符的不一致造成。回想两次操作，都是在push的时候提示要将CRLF替换成LF，”warning: CRLF will be replaced by LF”。接受IDE的建议修改以后，所有的文件的换行符都被替换，于是pre-commit文件的行尾也多了”\r”字符，导致运行时报错。<br><figure class="highlight awk"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line>.git<span class=regexp>/hooks/</span>pre-commit: line <span class=number>4</span>: [: <span class=number>127</span> : integer expression expected</span><br><span class=line>.git<span class=regexp>/hooks/</span>pre-commit: line <span class=number>5</span>: <span class=keyword>exit</span>: <span class=number>0</span> : numeric argument required</span><br></pre></td></tr></table></figure></p><p>找到问题的原因后，解决方案就呼之欲出了。删除掉多余的字符即可。</p><figure class="highlight vim"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>cp</span> .git/hooks/<span class=keyword>pre</span>-commit /tmp/<span class=keyword>pre</span>-commit</span><br><span class=line><span class=keyword>tr</span> -d <span class=string>'\r'</span> &lt; /tmp/<span class=keyword>pre</span>-commit &gt; .git/hooks/<span class=keyword>pre</span>-commit</span><br></pre></td></tr></table></figure><p>如果还有其余文件报错，一并处理即可。</p></span></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/12/15/idea-remote-debug/" itemprop=url>使用IntelliJ Idea进行远程调试</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-12-15T14:29:30+08:00 content=2016-12-15>2016-12-15</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><p>最近接手了一个烂摊子项目，据说是多少年前的了，没有人会部署本地环境，只能在服务器上通过脚本部署。这么一来就没法使用IDE的调试功能了，排查问题很不方便，跟同事一沟通，发现他们之前是用远程调试来排查问题。用了这么久Idea了，今天还是第一次知道还有远程调试这个功能。本篇就记录一下怎么在Idea里开启远程调试。</p><ol><li><p>开启远程访问端口启动服务<br>以java应用启动为例，启动参数里要添加这条额外的命令：</p><figure class="highlight excel"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>-Xrunjd<span class=symbol>wp:tr</span>ansport=dt_socket,<span class=built_in>address</span>=<span class=number>8089</span>,server=y,suspend=<span class=built_in>n</span></span><br></pre></td></tr></table></figure><p>其中的address就是要开启的远程访问端口</p></li></ol><div class="post-more-link text-center"><a class=btn href="/2016/12/15/idea-remote-debug/" rel=contents>阅读全文 &raquo;</a></div></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/12/08/idea-jvm/" itemprop=url>idea调整jvm参数加快启动编译速度</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-12-08T10:09:57+08:00 content=2016-12-08>2016-12-08</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><span itemprop=articleBody><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><p>最近换了个团队，被逼搞起了java+react。在使用webpack打包编译react代码或者使用maven启动java的时候，IntelliJ IDEA卡的跟孙子似的，人生就在这一分一秒的等待中度过，真是让人焦虑的不行。可是我大Think carbon x1可是8G的大内存机器，怎么会这么慢呢。。一开始听说idea就是内存杀手的我还以为是正常的，直到又一次项目直接起不来，并且还报错内存不够用，这真是让人不能接受了，8G的内存起个java说内存不够用？于是听说过jvm参数一说的我怀疑了下是不是idea设置的不太对。。</p><h2 id=JVM参数><a href=#JVM参数 class=headerlink title=JVM参数></a>JVM参数</h2><p>设置JVM内存的参数有四个：</p><ol><li>-Xmx Java Heap最大值，默认为物理内存的四分之一</li><li>-Xms Java Heap初始值，最好将-Xmx和-Xms设置为相同值，避免垃圾回收时由于差值造成时间开销增大</li><li>-Xmn Java Heap Young区大小，最好保留默认值</li><li>-Xss 每隔线程Stack的大小，最好保留默认值</li></ol><h2 id=修改Idea-JVM参数><a href=#修改Idea-JVM参数 class=headerlink title="修改Idea JVM参数"></a>修改Idea JVM参数</h2><p>打开idea的安装目录，切换到bin目录下，找到jvm的参数配置文件，32位程序为<code>idea.exe.vmoptions</code>，64位位<code>idea64.exe.vmoptions</code><br>我的打开后看了下，-Xmx和-Xms默认都是设置了128m。。尼玛，什么年代了，给分配128兆内存，怪不得卡成翔。<br>果断调整设置分配4096m，其他保持默认不修改。</p><figure class="highlight haml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre></td><td class=code><pre><span class=line>-<span class=ruby>Xms4096m</span></span><br><span class=line><span class=ruby>-Xmx4096m</span></span><br><span class=line><span class=ruby>-<span class=symbol>XX:</span>ReservedCodeCacheSize=<span class=number>240</span>m</span></span><br><span class=line><span class=ruby>-<span class=symbol>XX:</span>+UseConcMarkSweepGC</span></span><br><span class=line><span class=ruby>-<span class=symbol>XX:</span>SoftRefLRUPolicyMSPerMB=<span class=number>50</span></span></span><br><span class=line><span class=ruby>-ea</span></span><br><span class=line><span class=ruby>-Dsun.io.useCanonCaches=<span class=literal>false</span></span></span><br><span class=line><span class=ruby>-Djava.net.preferIPv4Stack=<span class=literal>true</span></span></span><br><span class=line><span class=ruby>-<span class=symbol>XX:</span>+HeapDumpOnOutOfMemoryError</span></span><br><span class=line><span class=ruby>-<span class=symbol>XX:</span>-OmitStackTraceInFastThrow</span></span><br><span class=line><span class=ruby>-<span class=symbol>Xverify:</span>none                  /<span class=regexp>/关闭Java字节码验证，从而加快了类装入的速度，并使得在仅为验证目的而启动的过程中无需装入类，缩短了启动时间。</span></span></span><br></pre></td></tr></table></figure><p>如果想提高启动速度，还可以将idea打开时默认加载的插件去掉一些自己不用的。路径是<code>File-&gt;Settings-&gt;Plugins</code>，勾掉自己不常用的。</p><p>关闭重启idea，那酸爽，没系安全带的我差点翻了车。。再试一下webpack打包，那是飞一样的感觉~~</p></span></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/09/14/carousel/" itemprop=url>手写组件化轮播</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-09-14T11:41:12+08:00 content=2016-09-14>2016-09-14</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><div class=post-gallery itemscope itemtype=//schema.org/ImageGallery><div class=post-gallery-row><a class="post-gallery-img fancybox" href=https://camo.githubusercontent.com/603242775b598fb96d1b9da9c5a9e54d8fd686c7/687474703a2f2f7777312e73696e61696d672e636e2f6d773639302f3632643935313537677731663773787a6c32326a7a6a32306a32306171676d372e6a7067 rel=gallery_cjnijyztc000wfnpvm1xmh17n itemscope itemtype=//schema.org/ImageObject itemprop=url><img src=https://camo.githubusercontent.com/603242775b598fb96d1b9da9c5a9e54d8fd686c7/687474703a2f2f7777312e73696e61696d672e636e2f6d773639302f3632643935313537677731663773787a6c32326a7a6a32306a32306171676d372e6a7067 itemprop=contentUrl></a></div></div><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><p>轮播效果在web开发中使用很频繁，之前一直是使用网上找来的插件，今天研究了一下自己实现了一下，没多大难度，还是很简单的，顺便再组件化了一把，以后再有需要就使用自己的了不用再用第三方插件了。知其然知其所以然，本篇博文对此做一分享。</p><h2 id=实现原理><a href=#实现原理 class=headerlink title=实现原理></a>实现原理</h2><p>让我们先来看一下轮播的实现原理。<br>轮播其实很类似于我们小时候玩的抽卡片的小玩意儿：底下一层是绘制好的图案，上面一层开了一个窗口，通过转动上层的窗口来展示底层不同的图案。<br>轮播也是这样，我们可以理解为：底层排列好了要轮播的图片，上层的窗口每次只展示一个图片，每点击一次窗口就滑动一次。</p><div class="post-more-link text-center"><a class=btn href="/2016/09/14/carousel/" rel=contents>阅读全文 &raquo;</a></div></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/08/31/message-restore/" itemprop=url>锤子手机短信恢复工具</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-08-31T20:25:16+08:00 content=2016-08-31>2016-08-31</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><h1 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h1><p>作为一个技术玩家，手机不ROOT真是怎么都不舒服。不ROOT没有掌控感：预装不能卸载、广告不能拦截、高级一点的应用不能安装…不能忍，于是今天又闲不下来折腾了下，结果又踩坑了。妈的，安卓手机品牌多样，真是踩坑无穷尽。这次倒是想到提前各种备份，还是栽在了短信恢复这事上。虽然现在短信已经用的不多了，有用的信息并不像以前那样多，但强迫症如我还是不恢复不舒服斯基。本篇博文主要想就锤子手机刷机root之后的短信恢复问题做一简单分享。绝对全网独家，别无他所，转载请注明出处，谢谢！</p><h1 id=问题描述><a href=#问题描述 class=headerlink title=问题描述></a>问题描述</h1><p>刷机root过程略去不表，我是2.6.2系统，使用手机端kingroot获取root权限成功。在root之前使用优优刷机助手备份了各种数据。优优刷机助手备份的短信格式是”.csv”格式的，因此本篇分享的方案也仅对”.csv”格式的备份文件起作用。</p><p>在备份完成获取root成功后，本欲使用优优刷机助手继续恢复数据，怎料在恢复短信的时候提示要更改默认短信应用才行，没截图了，找了一张豌豆荚的，提示一样：<br><img src=http://bbs-static.smartisan.cn/data/attachment/forum/201411/03/153649i25ddj3v8j2vhg5j.png></p><div class="post-more-link text-center"><a class=btn href="/2016/08/31/message-restore/" rel=contents>阅读全文 &raquo;</a></div></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/08/16/sendEmail/" itemprop=url>使用sendEmail在命令行下自动发送邮件</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-08-16T18:11:20+08:00 content=2016-08-16>2016-08-16</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><blockquote><p>偷懒是优秀程序员的美好品德。</p></blockquote><h1 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h1><p>作为一个码农，我们的原则是尽量把能自动化完成的任务交给机器。工作上一些流程性的邮件完全可以通过自动化实现。前端获取邮件信息，后端将信息组装发送出去。本篇博文将如何使用sendEmail发送邮件做一记录。</p><h1 id=安装><a href=#安装 class=headerlink title=安装></a>安装</h1><p>点击<a href="http://caspian.dotconf.net/menu/Software/SendEmail/" target=_blank rel=noopener>此处</a>，从官网下载sendEmail二进制文件。</p><h1 id=使用><a href=#使用 class=headerlink title=使用></a>使用</h1><p>官网的说明已经很完善，或者直接运行<code>sendEmail</code>命令，会打出详尽的命令参数。</p><p>主要的参数有：</p><figure class="highlight diff"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre></td><td class=code><pre><span class=line><span class=deletion>-t 收件人</span></span><br><span class=line><span class=deletion>-f 发件人</span></span><br><span class=line><span class=deletion>-u 邮件主题</span></span><br><span class=line><span class=deletion>-m 邮件内容 (也可以通过读取文件方式)</span></span><br><span class=line><span class=deletion>-s 发送邮件服务器</span></span><br><span class=line><span class=deletion>-a 发送附件</span></span><br><span class=line><span class=deletion>-cc 抄送人</span></span><br><span class=line><span class=deletion>-xu 发件人验证</span></span><br><span class=line><span class=deletion>-xp 发件人密码</span></span><br></pre></td></tr></table></figure><div class="post-more-link text-center"><a class=btn href="/2016/08/16/sendEmail/" rel=contents>阅读全文 &raquo;</a></div></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/08/05/node-ssh-shell/" itemprop=url>当node遇上远程执行shell命令</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-08-05T14:26:32+08:00 content=2016-08-05>2016-08-05</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><p>我有个Node.js项目，需要在node环境下调用shell命令。开始时只是单机调用，很简单，拼接好了shell命令，使用node的child_process调用一下就好了。随着系统规模的扩大，需要在node下进行调度，将任务分发到不同的机器上，于是就需要使用到ssh远程执行。简单一点的命令也还是可以执行的，但随着执行命令也复杂起来，参数里面有开始包含<code>&quot;,&#39;</code>时，问题就开始复杂了。</p><h2 id=node执行shell命令或脚本><a href=#node执行shell命令或脚本 class=headerlink title=node执行shell命令或脚本></a>node执行shell命令或脚本</h2><p>让我们一步步来看一下这个问题是如何复杂起来的。首先先看一下，node下如何执行shell脚本或命令。<br>以执行命令为例：(执行脚本可以等同于执行命令，只需要将大量命令先写成脚本，再执行脚本即可)</p><p>node提供了一个child_process的子进程API，借助该API可以调用系统命令。<br><figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre></td><td class=code><pre><span class=line><span class=keyword>var</span> exec = <span class=built_in>require</span>(<span class=string>'child_process'</span>).exec;</span><br><span class=line></span><br><span class=line><span class=keyword>var</span> cmd = <span class=string>"ls -al"</span>;</span><br><span class=line></span><br><span class=line><span class=keyword>var</span> out = exec(cmd);</span><br><span class=line></span><br><span class=line>out.stdout.on(<span class=string>'data'</span>,<span class=function><span class=keyword>function</span>(<span class=params>data</span>)</span>&#123;</span><br><span class=line>	<span class=built_in>console</span>.log(<span class=string>"stdout: "</span> + data);</span><br><span class=line>&#125;);</span><br><span class=line></span><br><span class=line>out.on(<span class=string>'exit'</span>,<span class=function><span class=keyword>function</span>(<span class=params>code</span>)</span>&#123;</span><br><span class=line>	<span class=built_in>console</span>.log(code);</span><br><span class=line>&#125;);</span><br></pre></td></tr></table></figure></p><p>上述代码片段将运行<code>ls -al</code>后输出结果，并输出命令执行后的返回码。</p><div class="post-more-link text-center"><a class=btn href="/2016/08/05/node-ssh-shell/" rel=contents>阅读全文 &raquo;</a></div></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/08/04/xz-decompress/" itemprop=url>xz格式文件的解压</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-08-04T16:34:42+08:00 content=2016-08-04>2016-08-04</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><span itemprop=articleBody><p>安装node的时候经常会下载到xz格式的压缩包，它是tar包外层在用xz压缩一遍，压缩比更高。</p><p>用的不是很多，但正因为此每次用到都要查一下，记录一下：</p><figure class="highlight cmake"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre></td><td class=code><pre><span class=line><span class=comment>#解压：</span></span><br><span class=line>xz -d <span class=keyword>file</span>.xz</span><br><span class=line>tar -xvf <span class=keyword>file</span>.tar</span><br><span class=line></span><br><span class=line><span class=comment>#如果没有xz命令，安装一下</span></span><br><span class=line>sudo yum <span class=keyword>install</span> xz</span><br></pre></td></tr></table></figure></span></div><footer class=post-footer><div class=post-eof></div></footer></article><article class="post post-type-normal" itemscope itemtype=//schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href="/2016/07/19/find-xargs-cp/" itemprop=url>使用find结合xargs进行大批量复制</a></h1><div class=post-meta><span class=post-time>发表于<time itemprop=dateCreated datetime=2016-07-19T19:59:32+08:00 content=2016-07-19>2016-07-19</time></span> <span class=post-category>&nbsp; | &nbsp; 分类于 <span itemprop=about itemscope itemtype=https://schema.org/Thing><a href="/categories/技术人生/" itemprop=url rel=index><span itemprop=name>技术人生</span></a></span></span></div></header><div class=post-body><span itemprop=articleBody><h5 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h5><p>今天在写脚本的时候遇到这么一个问题，cp复制过程中报错：<br><figure class="highlight autohotkey"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=symbol>cp:</span> will <span class=literal>not</span> overwrite just-created `xxxx'</span><br></pre></td></tr></table></figure></p><p>没来由的，cp这么基础的命令怎么还会出错？想了想我这命令也就复制的文件多一点，可能是cp的文件太多了，导致cp参数超限了。于是开始验证，同样的复制命令，删除了一些文件之后就cp成功了。</p><p>虽然根据谷歌查找到的<a href=http://unix.stackexchange.com/questions/110282/cp-max-source-files-number-arguments-for-copy-utility target=_blank rel=noopener><strong>资料</strong></a>显示，我这cp的源文件长度还远没有到达最大限制。不纠缠于此，既然文件太多了，那么使用xargs来复制吧。</p><h5 id=xargs><a href=#xargs class=headerlink title=xargs></a>xargs</h5><p>直接附上命令：<br><figure class="highlight elm"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line><span class=title>find</span> $&#123;src_dir&#125; -<span class=keyword>type</span> f | xargs -i cp &#123;&#125; $&#123;dst_dir&#125;</span><br></pre></td></tr></table></figure></p><p>由于cp是二元操作，需要传入源文件，这里需要使用xargs的替换模式。使用<code>-i</code>参数，然后可以使用<code>{}</code>表示来自标准输入的参数。</p></span></div><footer class=post-footer><div class=post-eof></div></footer></article></section><nav class=pagination><a class="extend prev" rel=prev href="/page/3/"><i class="fa fa-angle-left"></i></a><a class=page-number href="/">1</a><span class=space>&hellip;</span><a class=page-number href="/page/3/">3</a><span class="page-number current">4</span><a class=page-number href="/page/5/">5</a><span class=space>&hellip;</span><a class=page-number href="/page/8/">8</a><a class="extend next" rel=next href="/page/5/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop=author itemscope itemtype=//schema.org/Person><img class=site-author-image src=/images/default_avatar.jpg alt=但丁 itemprop=image><p class=site-author-name itemprop=name>但丁</p></div><p class="site-description motion-element" itemprop=description>一个伪文青，一个low geek 孤单的坚持码字</p><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/archives><span class=site-state-item-count>80</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories><span class=site-state-item-count>5</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags><span class=site-state-item-count>130</span> <span class=site-state-item-name>标签</span></a></div></nav><div class="feed-link motion-element"><a href=/rss2.xml rel=alternate><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/zhangjh target=_blank><i class="fa fa-globe"></i> github</a></span> <span class=links-of-author-item><a href=http://weibo.com/jhspider target=_blank><i class="fa fa-globe"></i> weibo</a></span> <span class=links-of-author-item><a href=http://douban.com/people/48165389 target=_blank><i class="fa fa-globe"></i> douban</a></span></div><div class="cc-license motion-element" itemprop=license><a href=//creativecommons.org/licenses/by-nc-sa/4.0 class=cc-opacity target=_blank><img src=/images/cc-by-nc-sa.svg alt="Creative Commons"></a></div><div class="links-of-author motion-element"></div></section></div></aside></main><footer id=footer class=footer><div class=footer-inner><div class=copyright>&copy; 2015 - <span itemprop=copyrightYear>2018</span> <span class=with-love><i class="icon-next-heart fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>但丁</span></div><div class=powered-by><span id=cnzz_stat_icon_1255577055></span><script src="//s4.cnzz.com/stat.php?id=1255577055&show=pic"></script></div><div class=powered-by>主题 - <a class=theme-link href=javascript:;>NexT.Mist</a></div><div class=powered-by-noline><a href=/issue>网站大事记</a></div><div class=ba-wrapper><div class=ba-info><a target=_blank href="http://www.miitbeian.gov.cn/">浙ICP备16000871-1号</a></div><div class=ba-info><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010802005049"><img src=/images/beian.png> 浙公网安备 33010802005049号</a></div></div><script>
	//将反斜杠替换成下划线,并将中文decode
    var curUrl = decodeURI(window.location.pathname.replace(new RegExp('\\/|\\.', 'g'),"_"));
   
	var statUrl = "https://favlink.cn/visit";

	// 总数
	$.ajax({
		url: statUrl,
		data: {
			url: "sum"
		}
	}).done(function(ret){
		if(ret.cnt > 1){
			if($("#totalCnt").length){
					$("#totalCnt").remove();
			}
			$("span.author").append(" | <span id='totalCnt'>自2016.4.12起总访问量：" + ret.cnt + "次");
		}
	});

	// 明细
	if(curUrl !== "_") {
		$.ajax({
			url: statUrl,
			data: {
				url: curUrl
			}
		}).done(function(ret){
			if(ret.cnt >1){
				$("#detail_cnt").text(ret.cnt);
			}	
		});
	}
</script><br></div></footer><div class=back-to-top></div></div><script type=text/javascript src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type=text/javascript src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type=text/javascript src=/vendors/fancybox/source/jquery.fancybox.pack.js></script><script type=text/javascript src="/js/fancy-box.js?v=1.0.0.0"></script><script type=text/javascript src="/js/helpers.js?v=1.0.0.0"></script><script type=text/javascript src=/vendors/velocity/velocity.min.js></script><script type=text/javascript src=/vendors/velocity/velocity.ui.min.js></script><script type=text/javascript src="/js/motion.js?v=1.0.0.0" id=motion.global></script><script type=text/javascript src=/js/bootstrap.js></script><script src=/js/custom.js></script></body></html>